import{b as r,c as d,d as e,t as p,F as g,i as h,r as x,U,o as H,f as l,w as n,u as o,e as I,M as O,V as S,g as m,X as q,l as M,a as A}from"./app.418331d3.js";import{r as N}from"./ExclamationIcon.da1e87e6.js";import{r as B}from"./TrashIcon.19cc4f16.js";import{s as L,a as R,_ as E,b as z,c as X,d as G}from"./JamarCurrencyTextBox.f21ecc62.js";import{f as J,g as K,h as Q,i as W,A as Y}from"./NewLayout.0a46786c.js";import{_ as Z}from"./LoadingButton.2b9415b2.js";import{_ as k}from"./Label.1f5ecdf3.js";import{_ as P}from"./InputError.f6eef736.js";import{_ as ee}from"./plugin-vue_export-helper.21dcd24c.js";import{_ as D}from"./Input.145b177d.js";import{_ as j}from"./ConfirmationModal.ecc8b347.js";import{_ as te}from"./DialogModal.200c4302.js";/* empty css            */import"./Modal.2b74a6df.js";const se={props:{history:{type:Object,required:!0}}},oe={class:"border-t"},le=e("td",{class:"px-2 italic font-bold border-t"},"Policy created",-1),ie={class:"border-t"},ne={class:"border-t"},ae=e("td",{class:"px-2 italic font-bold border-t"},"Policy updated",-1),re={class:"border-t"},de={class:"border-t"},ce={class:"px-2 border-t"},ue={class:"border-t"};function me(y,a,t,_,f,u){return t.history.event_type==="policy_created"?(r(),d(g,{key:0},[e("td",oe,p(t.history.created_at),1),le,e("td",ie,p(t.history.user_name),1)],64)):t.history.event_type==="policy_updated"?(r(),d(g,{key:1},[e("td",ne,p(t.history.created_at),1),ae,e("td",re,p(t.history.user_name),1)],64)):t.history.event_type==="note"?(r(),d(g,{key:2},[e("td",de,p(t.history.created_at),1),e("td",ce,p(t.history.message),1),e("td",ue,p(t.history.user_name),1)],64)):h("",!0)}var _e=ee(se,[["render",me]]);const ye={class:"flex items-center justify-center min-h-screen"},fe={class:"relative flex flex-col w-full h-screen bg-white md:h-auto md:max-w-lg md:my-auto md:rounded md:shadow-2xl"},pe=m(" History of Facts "),ve=m("Displays a history of facts"),be={key:0,class:"mx-2 my-4 overflow-y-scroll grow md:max-h-96 md:mx-7 md:my-5"},he={class:"w-full font-mono text-xs table-fixed"},ge=e("tr",null,[e("th",{scope:"col",class:"w-2/12"},"Date"),e("th",{scope:"col",class:"w-6/12"},"Message"),e("th",{scope:"col",class:"w-2/12"},"Agent")],-1),xe={class:"mx-2 my-4 md:mx-7 md:my-5"},we={props:{policy:{type:Object,required:!0}},setup(y){const a=y,t=x(!1),_=x([]),f=x(!1);let u=null;const v=U({message:"",policy_id:a.policy.id,event_type:"note"});function $(){u&&u.cancel(),u=axios.CancelToken.source(),f.value=!0,axios.get(route("histories.index"),{cancelToken:u.token,params:{"filter[policy_id]":a.policy.id}}).then(b=>{b&&(_.value=b.data,f.value=!1,u=null)})}H($);function w(b){t.value=b}function C(){v.post("/histories",{onSuccess:()=>{v.reset(),$()}})}function V(){v.reset(),w(!1)}return(b,c)=>(r(),d(g,null,[e("button",{class:"ml-auto btn btn-secondary",onClick:c[0]||(c[0]=s=>w(!0))},"History of facts"),l(o(W),{as:"div",class:"fixed inset-0 z-10 overflow-y-auto",open:t.value,onClose:w},{default:n(()=>[e("div",ye,[l(o(J),{class:"fixed inset-0 bg-black opacity-30"}),e("div",fe,[l(o(K),{class:"mx-2 my-4 md:mx-7 md:my-5"},{default:n(()=>[pe]),_:1}),l(o(Q),null,{default:n(()=>[ve]),_:1}),_.value.length>0?(r(),d("div",be,[e("table",he,[ge,(r(!0),d(g,null,I(_.value,s=>(r(),d("tr",{key:s.id},[l(_e,{history:s},null,8,["history"])]))),128))])])):h("",!0),e("div",xe,[l(k,{for:"message",value:"Message"}),O(e("textarea",{id:"address","onUpdate:modelValue":c[1]||(c[1]=s=>o(v).message=s),name:"address",class:"block w-full",rows:"2"},null,512),[[S,o(v).message]]),l(P,{message:o(v).errors.message},null,8,["message"])]),e("div",{class:"px-4 py-3 mt-auto bg-cool-grey-100 md:mt-0 sm:flex sm:flex-row-reverse sm:px-6"},[e("button",{class:"btn",onClick:V},"Close"),e("button",{class:"btn btn-primary",onClick:C},"Add")])])])]),_:1},8,["open"])],64))}},ke={class:"py-5 font-bold"},$e=m(" Policies "),Ce=e("span",{class:"font-medium text-light-blue-vivid-400"},"\xA0/",-1),Ve={class:"flex max-w-3xl mb-2"},Pe={class:"max-w-3xl overflow-hidden bg-white rounded shadow"},Ae={key:0,class:"flex items-center justify-between p-5 pl-8 bg-yellow-200"},De={class:"flex"},je=m(" This policy is deleted "),Ue={key:1,class:"flex items-center justify-between p-5 pl-8 bg-red-vivid-200"},Ie={class:"flex items-center"},Oe=e("div",{class:"text-lg"},"This policy does not have any policyholders",-1),Te={class:"p-8"},Fe={class:"mb-5"},He={class:"mb-5"},Se={class:"mb-5"},qe=["value"],Me={class:"mb-5"},Ne={class:"mb-5"},Be=e("div",{class:"text-sm text-left text-cool-grey-600"},"Period of Insurance",-1),Le=m(" Policyholders "),Re={class:"flex items-center justify-between px-8 py-4 bg-cool-grey-50"},Ee={class:"flex items-baseline"},ze={key:0,class:"mr-5 italic text-cool-grey-400"},Xe=m(" Update policy "),Ge=m(" Restore Policy "),Je=m(" Are you sure you want to restore this policy? "),Ke=m(" Delete Policy "),Qe=m(" Are you sure you want to delete the policy? "),We=m("Add Policyholder"),Ye={layout:Y},_t=Object.assign(Ye,{props:{errors:{type:Object,required:!0},policy:{type:Object,required:!0},fields:{type:Array,required:!1,default(){return[]}},users:{type:Array,required:!0}},setup(y){var b;const a=y,t=U({number:a.policy.number,contacts:a.policy.contacts,created_at:a.policy.created_at,period:{start:a.policy.period_start,end:a.policy.period_end},fields:(b=a.policy.fields)!=null?b:[],agent_id:a.policy.agent_id,premium:Number(a.policy.premium.amount)}),_=x(!1),f=x(!1),u=x(!1);function v(){t.transform(c=>({...c,period_start:c.period.start,period_end:c.period.end})).put(route("policies.update",a.policy.id))}function $(){t.delete(route("policies.destroy",a.policy.id)),_.value=!1}function w(){t.put(route("policies.restore",a.policy.id)),f.value=!1}function C(c){t.contacts.push(c),u.value=!1}function V(c){window.open(c.link,"_blank").focus()}return(c,s)=>{const T=A("InertiaHead"),F=A("InertiaLink");return r(),d(g,null,[e("div",ke,[l(T,{title:"Edit Policy"}),e("h1",null,[l(F,{class:"text-light-blue-vivid-400 hover:text-light-blue-vivid-600",href:"/"},{default:n(()=>[$e]),_:1}),Ce,m(" "+p(o(t).number),1)])]),e("div",Ve,[l(we,{policy:y.policy},null,8,["policy"])]),e("div",Pe,[y.policy.deleted_at?(r(),d("div",Ae,[e("div",De,[l(o(B),{class:"w-5 h-5 mr-2"}),je]),e("button",{class:"btn hover:underline",onClick:s[0]||(s[0]=i=>f.value=!0)},"Restore")])):h("",!0),o(t).contacts.length===0?(r(),d("div",Ue,[e("div",Ie,[l(o(N),{class:"w-5 h-5 mr-2"}),Oe])])):h("",!0),e("div",Te,[e("div",Fe,[l(k,{for:"number",value:"Policy Number"}),l(D,{id:"number",modelValue:o(t).number,"onUpdate:modelValue":s[1]||(s[1]=i=>o(t).number=i),type:"text",class:"block w-full"},null,8,["modelValue"]),l(P,{message:o(t).errors.number},null,8,["message"])]),e("div",He,[l(k,{value:"Date Issued"}),l(o(L),{modelValue:o(t).created_at,"onUpdate:modelValue":s[2]||(s[2]=i=>o(t).created_at=i),mode:"dateTime"},{default:n(({inputValue:i})=>[l(D,{id:"created_at",value:i,type:"text",class:"block w-full text-cool-grey-400",readonly:""},null,8,["value"])]),_:1},8,["modelValue"])]),e("div",Se,[l(k,{value:"Assigned Agent"}),O(e("select",{id:"agent","onUpdate:modelValue":s[3]||(s[3]=i=>o(t).agent_id=i),class:"mt-1 mr-5 border rounded border-cool-grey-200"},[(r(!0),d(g,null,I(y.users,i=>(r(),d("option",{key:i.id,value:i.id},p(i.name),9,qe))),128))],512),[[q,o(t).agent_id]])]),e("div",Me,[l(k,{value:"Premium"}),l(R,{id:"premium",modelValue:o(t).premium,"onUpdate:modelValue":s[4]||(s[4]=i=>o(t).premium=i),options:{currency:"PHP",valueScaling:"precision"},class:"mt-1 mr-5 border rounded border-cool-grey-200"},null,8,["modelValue"]),l(P,{message:o(t).errors.premium},null,8,["message"])]),e("div",Ne,[Be,l(E,{modelValue:o(t).period,"onUpdate:modelValue":s[5]||(s[5]=i=>o(t).period=i)},null,8,["modelValue"])]),l(z,{class:"mb-5",fields:o(t).fields,policy:y.policy,onFieldAdded:s[6]||(s[6]=i=>o(t).fields.push(i))},null,8,["fields","policy"]),o(t).contacts.length>0?(r(),M(X,{key:0,contacts:o(t).contacts,class:"mb-5",removable:"",onContactClicked:V},{default:n(()=>[Le]),_:1},8,["contacts"])):h("",!0),e("button",{class:"btn",onClick:s[7]||(s[7]=i=>u.value=!0)},"Add Policyholder")]),e("div",Re,[y.policy.deleted_at?h("",!0):(r(),d("button",{key:0,class:"text-red-vivid-600 hover:underline",tabindex:"-1",type:"button",onClick:s[8]||(s[8]=i=>_.value=!0)}," Delete policy ")),e("div",Ee,[o(t).isDirty?(r(),d("div",ze," Unsaved Changes ")):h("",!0),l(Z,{class:"btn btn-primary",type:"submit",loading:o(t).processing,onClick:v},{default:n(()=>[Xe]),_:1},8,["loading"])])])]),l(j,{show:f.value,onClose:s[10]||(s[10]=i=>f.value=!1)},{title:n(()=>[Ge]),content:n(()=>[Je]),footer:n(()=>[e("button",{class:"btn",onClick:s[9]||(s[9]=i=>f.value=!1)},"Cancel"),e("button",{class:"ml-2 btn btn-danger",onClick:w},"Restore")]),_:1},8,["show"]),l(j,{show:_.value,onClose:s[12]||(s[12]=i=>_.value=!1)},{title:n(()=>[Ke]),content:n(()=>[Qe]),footer:n(()=>[e("button",{class:"btn",onClick:s[11]||(s[11]=i=>_.value=!1)},"Cancel"),e("button",{class:"ml-2 btn btn-danger",onClick:$},"Delete Policy")]),_:1},8,["show"]),l(te,{show:u.value,onClose:s[14]||(s[14]=i=>u.value=!1)},{title:n(()=>[We]),content:n(()=>[l(G,{class:"m-4",onSelected:C})]),footer:n(()=>[e("button",{class:"btn",onClick:s[13]||(s[13]=i=>u.value=!1)},"Close")]),_:1},8,["show"])],64)}}});export{_t as default};
