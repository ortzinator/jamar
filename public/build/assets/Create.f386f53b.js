import{b as c,c as u,d as s,j as v,T as E,O as N,r as y,C as U,f as o,w as r,E as x,U as $,F as w,e as V,t as C,u as t,h as L,L as T,g as d,a as g}from"./app.3b878662.js";import{s as j,_ as B,a as O,b as M,c as q}from"./JamarCurrencyTextBox.b64586b0.js";import{A as H}from"./AppLayout.b9e59cce.js";import{_ as z}from"./TextInput.259eaf44.js";import{_ as p}from"./InputLabel.32e90572.js";import{_ as G}from"./LoadingButton.f70bfa57.js";import{_ as J}from"./plugin-vue_export-helper.21dcd24c.js";import{r as K}from"./ExclamationIcon.df042017.js";import"./TrashIcon.278f2c06.js";const Q={},R={class:"py-5 md:p-5 md:grid-cols-3 md:grid"},W={class:"md:col-span-1"},X={class:"text-lg"},Y={class:"text-sm text-cool-grey-700"},Z={class:"mt-5 md:col-span-2 md:mt-0"};function ee(a,e){return c(),u("div",R,[s("div",W,[s("div",X,[v(a.$slots,"header")]),s("div",Y,[v(a.$slots,"description")])]),s("div",Z,[v(a.$slots,"default")])])}var b=J(Q,[["render",ee]]);const se={class:"py-5 font-bold"},oe=d(" Policies "),te=s("span",{class:"font-medium text-light-blue-vivid-400"},"/",-1),le=d(" New Policy "),ie=["onSubmit"],ne={class:""},re=d("Basics"),de=d(" Description of this section "),ae={class:"grid grid-cols-6 gap-4"},ce={class:"col-span-6"},ue={class:"flex items-center"},me=["value"],_e={class:"col-span-6"},pe=["value"],fe={class:"col-span-6"},he={class:"col-span-6"},ve=d("Period of Insurance"),ge={class:"col-span-6"},be=s("hr",{class:"h-px border-0 bg-cool-grey-100 text-cool-grey-500"},null,-1),ye=d("Policy Fields"),xe=d(" Description of this section "),$e=s("hr",{class:"h-px border-0 bg-cool-grey-100 text-cool-grey-500"},null,-1),we=d("Policyholders"),Ve=d(" Add policyholders here "),Ce={class:"mb-5 text-yellow-vivid-600"},Pe=d(" Please add one or more policyholders "),ke=s("hr",{class:"h-px border-0 bg-cool-grey-100 text-cool-grey-500"},null,-1),Se={class:"flex justify-between mt-5"},Fe=s("div",null,"Problems?",-1),Ie=d(" Create Policy "),Ae={layout:H},Me=Object.assign(Ae,{__name:"Create",props:{users:{type:Array,required:!0},currency:{type:Object,required:!0}},setup(a){const e=E({number:null,contacts:[],period:[],fields:[],agent_id:N.page.props.user.id,premium:null}),P=y([{id:1,name:"none",label:"None",fields:null},{id:2,name:"vehicle",label:"Vehicle",fields:[{id:1,name:"license",value:""},{id:2,name:"vin",value:""}]}]),h=y(null);U(h,i=>{e.fields=[],i&&(e.fields.push(...i),e.fields.map(n=>{const f={...n};return f.protected=!0,f}))});function k(){e.transform(i=>({...i,period_start:i.period[0],period_end:i.period[1]})).post(route("policies.store"))}function S(i){return _.findIndex(e.contacts,n=>_.isMatch(n,i))>-1}function F(i){S(i)||e.contacts.push(i)}function I(i){window.open(i.link,"_blank").focus()}function A(i){_.pull(e.fields,i)}return(i,n)=>{const f=g("InertiaHead"),D=g("InertiaLink"),m=g("TextInputError");return c(),u("div",null,[s("div",se,[o(f,{title:"Create Policy"}),s("h1",null,[o(D,{class:"text-light-blue-vivid-400 hover:text-light-blue-vivid-600",href:i.route("policies")},{default:r(()=>[oe]),_:1},8,["href"]),te,le])]),s("form",{onSubmit:T(k,["prevent"])},[s("div",ne,[o(b,null,{header:r(()=>[re]),description:r(()=>[de]),default:r(()=>[s("div",ae,[s("div",ce,[o(p,{for:"template",value:"Policy Type"}),s("div",ue,[x(s("select",{"onUpdate:modelValue":n[0]||(n[0]=l=>h.value=l),class:"w-full mt-1 border rounded border-cool-grey-200"},[(c(!0),u(w,null,V(P.value,l=>(c(),u("option",{key:l.id,value:l.fields},C(l.label),9,me))),128))],512),[[$,h.value]])])]),s("div",_e,[o(p,{for:"agent",value:"Assigned Agent"}),x(s("select",{"onUpdate:modelValue":n[1]||(n[1]=l=>t(e).agent_id=l),class:"w-full mt-1 border rounded border-cool-grey-200"},[(c(!0),u(w,null,V(a.users,l=>(c(),u("option",{key:l.id,value:l.id},C(l.name),9,pe))),128))],512),[[$,t(e).agent_id]])]),s("div",fe,[o(p,{for:"number",value:"Policy Number"}),o(z,{id:"number",modelValue:t(e).number,"onUpdate:modelValue":n[2]||(n[2]=l=>t(e).number=l),type:"text",class:"block w-full mt-1"},null,8,["modelValue"]),o(m,{message:t(e).errors.number},null,8,["message"])]),s("div",he,[o(p,null,{default:r(()=>[ve]),_:1}),s("div",{class:L([{formError:t(e).errors.period_start||t(e).errors.period_end},"mt-1"])},[o(t(j),{modelValue:t(e).period,"onUpdate:modelValue":n[3]||(n[3]=l=>t(e).period=l),"selection-mode":"range","show-button-bar":"true"},null,8,["modelValue"])],2),o(m,{message:t(e).errors.period_start},null,8,["message"]),o(m,{message:t(e).errors.period_end},null,8,["message"])]),s("div",ge,[o(p,{value:`Premium (${a.currency.code})`},null,8,["value"]),o(B,{id:"premium",modelValue:t(e).premium,"onUpdate:modelValue":n[4]||(n[4]=l=>t(e).premium=l),options:{currency:a.currency.code,valueScaling:"precision"},class:"w-full mt-1 mr-5 border rounded border-cool-grey-200"},null,8,["modelValue","options"]),o(m,{message:t(e).errors.premium},null,8,["message"])])])]),_:1}),be,o(b,null,{header:r(()=>[ye]),description:r(()=>[xe]),default:r(()=>[o(O,{class:"mb-5",fields:t(e).fields,onFieldAdded:n[5]||(n[5]=l=>t(e).fields.push(l)),onFieldDeleted:A},null,8,["fields"])]),_:1}),$e,o(b,null,{header:r(()=>[we]),description:r(()=>[Ve]),default:r(()=>[o(M,{contacts:t(e).contacts,class:"mb-5",removable:"",onContactClicked:I},{noContacts:r(()=>[s("div",Ce,[o(t(K),{class:"inline w-5 h-5 mr-2"}),Pe])]),_:1},8,["contacts"]),o(m,{message:t(e).errors.contacts},null,8,["message"]),o(q,{onSelected:F})]),_:1}),ke,s("div",Se,[Fe,o(G,{class:"btn btn-primary",type:"submit",loading:t(e).processing},{default:r(()=>[Ie]),_:1},8,["loading"])])])],40,ie)])}}});export{Me as default};
