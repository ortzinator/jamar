import{b as c,c as u,d as s,j as v,U as N,I as U,r as y,C as j,f as o,w as r,u as t,Q as B,F as g,g as d,a as x,M as $,X as V,e as w,t as P,h as L}from"./app.f41975ad.js";import{r as M}from"./ExclamationIcon.514d6e83.js";import{A as E}from"./NewLayout.54c0939e.js";import{_ as H}from"./Input.812f980a.js";import{_ as m}from"./Label.58d8b60c.js";import{_ as p}from"./InputError.2d876182.js";import{_ as q}from"./LoadingButton.bea9e802.js";import{_ as O,a as T,b as z,c as Q,d as X}from"./JamarCurrencyTextBox.cc75b9b8.js";import{_ as G}from"./plugin-vue_export-helper.21dcd24c.js";import"./TrashIcon.78cf752d.js";const J={},K={class:"py-5 md:p-5 md:grid-cols-3 md:grid"},R={class:"md:col-span-1"},W={class:"text-lg"},Y={class:"text-sm text-cool-grey-700"},Z={class:"mt-5 md:col-span-2 md:mt-0"};function ee(a,e){return c(),u("div",K,[s("div",R,[s("div",W,[v(a.$slots,"header")]),s("div",Y,[v(a.$slots,"description")])]),s("div",Z,[v(a.$slots,"default")])])}var b=G(J,[["render",ee]]);const se={class:"py-5 font-bold"},oe=d(" Policies "),te=s("span",{class:"font-medium text-light-blue-vivid-400"},"/",-1),le=d(" New Policy "),ie=["onSubmit"],ne={class:""},re=d("Basics"),de=d(" Description of this section "),ae={class:"grid grid-cols-6 gap-4"},ce={class:"col-span-6 sm:col-span-4"},ue={class:"flex items-center"},me=["value"],_e={class:"col-span-6 sm:col-span-4"},pe=["value"],fe={class:"col-span-6 sm:col-span-4"},he={class:"col-span-6 sm:col-span-4"},ve=d("Period of Insurance"),ge={class:"col-span-6 sm:col-span-4"},be=s("hr",{class:"h-px border-0 bg-cool-grey-100 text-cool-grey-500"},null,-1),ye=d("Policy Fields"),xe=d(" Description of this section "),$e=s("hr",{class:"h-px border-0 bg-cool-grey-100 text-cool-grey-500"},null,-1),Ve=d("Policyholders"),we=d(" Add policyholders here "),Pe={class:"mb-5 text-yellow-vivid-600"},ke=d(" Please add one or more policyholders "),Ce=s("hr",{class:"h-px border-0 bg-cool-grey-100 text-cool-grey-500"},null,-1),Fe={class:"flex justify-between mt-5"},Se=s("div",null,"Problems?",-1),Ie=d(" Create Policy "),Ae={layout:E},Oe=Object.assign(Ae,{props:{users:{type:Array,required:!0},currency:{type:Object,required:!0}},setup(a){const e=N({number:null,contacts:[],period:{start:null,end:null},fields:[],agent_id:U.Inertia.page.props.user.id,premium:null}),k=y([{id:1,name:"none",label:"None",fields:null},{id:2,name:"vehicle",label:"Vehicle",fields:[{id:1,name:"license",value:""},{id:2,name:"vin",value:""}]}]),h=y(null);j(h,i=>{e.fields=[],i&&(e.fields.push(...i),e.fields.map(n=>{const f={...n};return f.protected=!0,f}))});function C(){e.transform(i=>({...i,period_start:i.period.start,period_end:i.period.end})).post(route("policies.store"))}function F(i){return _.findIndex(e.contacts,n=>_.isMatch(n,i))>-1}function S(i){F(i)||e.contacts.push(i)}function I(i){window.open(i.link,"_blank").focus()}function A(i){_.pull(e.fields,i)}return(i,n)=>{const f=x("InertiaHead"),D=x("InertiaLink");return c(),u(g,null,[s("div",se,[o(f,{title:"Create Policy"}),s("h1",null,[o(D,{class:"text-light-blue-vivid-400 hover:text-light-blue-vivid-600",href:i.route("policies")},{default:r(()=>[oe]),_:1},8,["href"]),te,le])]),s("form",{onSubmit:B(C,["prevent"])},[s("div",ne,[o(b,null,{header:r(()=>[re]),description:r(()=>[de]),default:r(()=>[s("div",ae,[s("div",ce,[o(m,{for:"template",value:"Policy Type"}),s("div",ue,[$(s("select",{"onUpdate:modelValue":n[0]||(n[0]=l=>h.value=l),class:"w-full mt-1 border rounded border-cool-grey-200"},[(c(!0),u(g,null,w(k.value,l=>(c(),u("option",{key:l.id,value:l.fields},P(l.label),9,me))),128))],512),[[V,h.value]])])]),s("div",_e,[o(m,{for:"agent",value:"Assigned Agent"}),$(s("select",{"onUpdate:modelValue":n[1]||(n[1]=l=>t(e).agent_id=l),class:"w-full mt-1 border rounded border-cool-grey-200"},[(c(!0),u(g,null,w(a.users,l=>(c(),u("option",{key:l.id,value:l.id},P(l.name),9,pe))),128))],512),[[V,t(e).agent_id]])]),s("div",fe,[o(m,{for:"number",value:"Policy Number"}),o(H,{id:"number",modelValue:t(e).number,"onUpdate:modelValue":n[2]||(n[2]=l=>t(e).number=l),type:"text",class:"block w-full mt-1"},null,8,["modelValue"]),o(p,{message:t(e).errors.number},null,8,["message"])]),s("div",he,[o(m,null,{default:r(()=>[ve]),_:1}),s("div",{class:L([{formError:t(e).errors.period_start||t(e).errors.period_end},"mt-1"])},[o(O,{modelValue:t(e).period,"onUpdate:modelValue":n[3]||(n[3]=l=>t(e).period=l)},null,8,["modelValue"])],2),o(p,{message:t(e).errors.period_start},null,8,["message"]),o(p,{message:t(e).errors.period_end},null,8,["message"])]),s("div",ge,[o(m,{value:`Premium (${a.currency.code})`},null,8,["value"]),o(T,{id:"premium",modelValue:t(e).premium,"onUpdate:modelValue":n[4]||(n[4]=l=>t(e).premium=l),options:{currency:"PHP",valueScaling:"precision"},class:"mt-1 mr-5 border rounded border-cool-grey-200"},null,8,["modelValue"]),o(p,{message:t(e).errors.premium},null,8,["message"])])])]),_:1}),be,o(b,null,{header:r(()=>[ye]),description:r(()=>[xe]),default:r(()=>[o(z,{class:"mb-5",fields:t(e).fields,onFieldAdded:n[5]||(n[5]=l=>t(e).fields.push(l)),onFieldDeleted:A},null,8,["fields"])]),_:1}),$e,o(b,null,{header:r(()=>[Ve]),description:r(()=>[we]),default:r(()=>[o(Q,{contacts:t(e).contacts,class:"mb-5",removable:"",onContactClicked:I},{noContacts:r(()=>[s("div",Pe,[o(t(M),{class:"inline w-5 h-5 mr-2"}),ke])]),_:1},8,["contacts"]),o(p,{message:t(e).errors.contacts},null,8,["message"]),o(X,{onSelected:S})]),_:1}),Ce,s("div",Fe,[Se,o(q,{class:"btn btn-primary",type:"submit",loading:t(e).processing},{default:r(()=>[Ie]),_:1},8,["loading"])])])],40,ie)],64)}}});export{Oe as default};
